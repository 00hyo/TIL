# 페이징의 이점과 계층적 페이징

[페이징 이점](#페이징-이점)

[fork 시스템 호출](#fork-시스템-호출)

[Copy On Write(쓰기 시 복사)](#Copy-On-Write(쓰기-시-복사)) 

[계층적 페이징](#계층적-페이징)

### 페이징 이점

외부 단편화 문제 해결, 프로세스 간의 페이지를 공유(공유 라이브러리) , 호율적인 메모리 사용, 메모리 보호, 대용량 프로그램 실행

### fork 시스템 호출

프로세스끼리 자원을 공유하지 않기 때문에 fork 시스템 호출
→ 부모 프로세스가 적재된 별도의 공간에 자식 프로세스가 통째로 복제되어 적재 

- 새로운 프로세스 생성
- 각각의 프로세스는 자신의 독립적인 실행 흐름 가짐

(프로세스 생성 시간 지연, 동일 내용 중복 적재로 인한 메모리 낭비)

이러한 단점 보완⇒ 쓰기 시 복사 

### Copy On Write(쓰기 시 복사)

부모 프로세스와 동일한 자식 프로세스가 복제되어 생성되면

자식 프로세스는 부모 프로세스와 **동일한 프레임을 가리킴** ← 쓰기 작업이 없다면 이 상태를 유지

부모 프로세스/자식 프로세스 둘 중 하나 페이지에 쓰기 작업 수행 시

해당 페이지는 별도의 공간으로 복제 →서로 별도의 자원을 유지하면서 중복 해서 메모리를 저장하지 않는 방식으로 메모리를 효율적으로 관리 

- 메모리를 공유하는 프로세스 간에 쓰기가 발생할 때만 해당 페이지를 복사
- 각각의 프로세스가 자신의 페이지 버전을 가짐

(프로세스 생성 시간 절약, 메모리 절약)

### 계층적 페이징

가상 메모리 주소 공간을 여러 개의 작은 페이지로 분할하여 물리 메모리와 매핑하는 방법 

- 프로세스 테이블의 크기는 생각보다 작지 않다
- 프로세스를 이루는 모든 페이지 테이블 엔트리를 메모리에 두는 것은 큰 낭비이다.
- 프로세스를 이루는 모든 페이지 테이블 엔트리(페이지 번호 + 페이지의 물리 주소)를 항상 메모리에 유지하지 않는 방법이다.

*가상 메모리: 프로세스의 주소 공간, 프로그램이 메모리에 적재되어 실행될 때 해당 주소 공간이 할당 프로세스 간에 서로 독립적인 메모리 공간을 제공

*물리 메모리: 컴퓨터의 실제 메모리 하드웨어로, 컴퓨터가 프로그램을 실행할 때 사용되는 실제 물리적인 메모리 

- 페이지 테이블을 페이징하여 여러 단계의 페이지를 두는 방식
    
    ![Untitled (25)](https://github.com/HYO00/TIL/assets/79884004/be76ad59-ef71-446f-9d02-68e738242559)
    
    페이지 테이블을 여러 페이지로 쪼개고 이 페이지를 가리키는 페이지 테이블을 두는 방식 
    
- 모든 페이지 테이블을 항상 메모리에 저장할 필요가 없어짐
    - CPU와 가장 가까이 위치한 Outer 페이지 테이블은 항상 메모리에 유지
- 계층적 페이징을 이용하는 환경에서의 논리 주소
    
    
    | 바깥 페이지 번호 | 안쪽 페이지 번호  | 변위  |
    | --- | --- | --- |
    
    ![Untitled (26)](https://github.com/HYO00/TIL/assets/79884004/5809be49-ba1c-44cc-98b3-99b6b1232ae3)

    
    [2단계 계층적 페이징]
