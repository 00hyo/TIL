# 프로세스 동기화

동시다발적으로 실행되는 프로세스들은 서로 협력하며 영향을 주고 받는다 이 과정에서 자원의 일관성을 보장해야 한다. 

### 동기화의 의미

공동의 목적을 위해 동시에 수행되는 프로세스 

- (프로세스) 동기화란?
    
    프로세스들의 수행 시기를 맞추는 것 
    
- **실행 순서 제어**: 프로세스를 올바른 순서대로 실행하기
- **상호배제**: 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하기

*실행 문맥을 갖는 모든 대상은 동기화 대상이기에 동기화는 쓰레드도 포함되는 개념이다. 

- 실행 순선 제어를 위한 동기화 : reader writer problem
    - Writer: Book.txt 파일 값을 저장하는 프로세스
    - Reader: Book.txt 파일에 저장된 값을 읽어들이는 프로세스
    
    동시 실행 시?
    
    실행 순서가 존재 
    
- 상호 배제를 위한 동기화: Bank account problem
    - 공유 불가능 자원의 동시 사용을 피하기 위한 동기화
    - **한 번에 하나의 프로세스만 접근해야 하는 자원**에 동시 접근을 피하기 위한 동기화
    
    예시 
    현재 계좌 잔액 : 10만원 
    프로세스 A → 계좌에 2만원 추가
    
    프로세스 B → 계좌에 5만원 추가 
    
    결과 15만원?
    
    동시에 접근해서는 안되는 ‘잔액’에 동시에 접근 했기 때문
    
    프로세스 A, B는 잔액이라는 데이터의 한 번에 하나만 접근해야 한다. 
    

### 동기화 예제

Producer & Consumer problem

물건을 계속해서 생산하는 생산자 (프로세스 혹은 스레드)

물건을 계속해서 소비하는 소비자 (프로세스 혹은 스레드)

‘총합’ 변수 공유? 

```jsx
총합 = 10

생산자 () {
	버퍼에 데이터 삽입
	'총합' 변수 1 증가
}
소비자 () {
	버퍼에 데이터 빼기
	'총합' 변수 1 감소
}
```

 결과는 0 이 아님 동시 접근 문제 발생 

### 공유 자원과 임계 구역

- 공유 자원: 여러 프로세스 혹은 스레드가 공유하는 자원
    
    전역 변수, 파일 , 입출력장치, 보조기억장치,…
    
- 임계 구역: 동시에 실행하면 문제가 발생하는 자원에 접근하는 코드 영역 
임계구역에 내가 아닌 다른 프로세스가 실행중이라면 대기 후 들어간다.
    
    ***레이스 컨디션(race condition)**  - 임계 구역에 동시에 접근 시 자원의 일관성이 깨짐
    

운영체제가 임계구역 문제를 해결하는 세 가지 원칙 

(상호 배제를 위한 동기화를 위하 세 가지 원칙)

1. 상호 배제 (mutual exclusion)
한 프로세스가 임계 구역 진입 → 다른 프로세스 못들어옴 
2. 진행 (progress)
임계 구역에 어떤 프로세스도 진입 X → 진입하고자 하는 프로세스는 들어갈 수 있어야 함 
3. 유한 대기 (bounded waiting)
    
    한 프로세스가 임계 구역 진입 하고 싶다 → 언젠가 임계 구역에 들어와야 함 (계속 못 들어오면 안됨!)
